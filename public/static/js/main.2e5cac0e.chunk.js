(this["webpackJsonpreact-rails-api-project-template-client"]=this["webpackJsonpreact-rails-api-project-template-client"]||[]).push([[0],{30:function(e,t,n){},31:function(e,t,n){},34:function(e,t,n){},35:function(e,t,n){"use strict";n.r(t);var c=n(0),s=n.n(c),i=n(24),r=n.n(i),o=(n(30),n(4)),a=(n(31),n(3)),l=n(6),j=n(8),u=n(1);var d=function(e){var t=e.setListener,n=Object(c.useState)(!1),s=Object(o.a)(n,2),i=s[0],r=s[1],a=Object(c.useState)(!1),d=Object(o.a)(a,2),b=d[0],h=d[1],O=Object(c.useState)({username:"",password:""}),g=Object(o.a)(O,2),x=g[0],f=g[1],p=Object(c.useState)({name:"",profile_pic:"",username:"",password:"",password_confirmation:""}),m=Object(o.a)(p,2),v=m[0],S=m[1];function y(e){var t=e.target.name;f(Object(j.a)(Object(j.a)({},x),{},Object(l.a)({},t,e.target.value))),r(!1)}function C(e){var t=e.target.name;S(Object(j.a)(Object(j.a)({},v),{},Object(l.a)({},t,e.target.value))),h(!1)}return Object(u.jsxs)("div",{children:[Object(u.jsx)("h1",{children:"Login"}),Object(u.jsxs)("form",{id:"login",onSubmit:function(e){e.preventDefault(),fetch("login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(x)}).then((function(e){if(!e.ok)throw r(!0),new Error("HTTP error, status = ".concat(e.status));console.log(e),e.json().then((function(e){console.log(e),t(e)}))})).catch((function(e){console.error(e)})),e.target.children[1].value="",e.target.children[3].value=""},children:[Object(u.jsx)("label",{children:"Username: "}),Object(u.jsx)("input",{type:"text",name:"username",onChange:y}),Object(u.jsx)("label",{children:"   Password: "}),Object(u.jsx)("input",{type:"text",name:"password",onChange:y}),Object(u.jsx)("input",{type:"submit",value:"Login"})]}),i?Object(u.jsx)("p",{style:{color:"red"},children:"Invalid Username or Password"}):null,Object(u.jsx)("h1",{children:"Sign Up!"}),Object(u.jsxs)("form",{id:"sign up",onSubmit:function(e){e.preventDefault(),fetch("listeners",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(v)}).then((function(e){if(!e.ok)throw h(!0),new Error("HTTP error, status = ".concat(e.status));e.json().then((function(e){console.log(e)}))})).catch((function(e){console.error(e)})),e.target.children[1].value="",e.target.children[3].value="",e.target.children[5].value="",e.target.children[7].value=""},children:[Object(u.jsx)("label",{children:"Name: "}),Object(u.jsx)("input",{type:"text",name:"name",onChange:C}),Object(u.jsx)("label",{children:"Username: "}),Object(u.jsx)("input",{type:"text",name:"username",onChange:C}),Object(u.jsx)("label",{children:"Password:"}),Object(u.jsx)("input",{type:"text",name:"password",onChange:C}),Object(u.jsx)("label",{children:"Confirm Password:"}),Object(u.jsx)("input",{type:"text",name:"password_confirmation",onChange:C}),Object(u.jsx)("input",{type:"submit",value:"Signup"})]}),b?Object(u.jsx)("p",{style:{color:"red"},children:"Invalid Signup Info"}):null]})};var b=function(e){var t=e.setListener;return Object(u.jsxs)("div",{children:[Object(u.jsx)("h1",{children:"See you later!"}),Object(u.jsx)("button",{onClick:function(e){e.preventDefault(),fetch("logout",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify(null)}).then((function(e){return console.log(e)})).then((function(){t(null)}))},children:"Logout"})]})},h=Object(c.createContext)();var O=function(e){var t=e.song;return Object(u.jsx)("div",{className:"song-contianer",children:Object(u.jsxs)("div",{className:"song-card",children:[Object(u.jsx)("h3",{className:"left",children:t.title}),Object(u.jsxs)("h4",{className:"right",children:[" by ",t.artist]})]})})};var g=function(){var e,t=Object(c.useContext)(h);return null!=t&&(e=t.songs.map((function(e){return Object(u.jsx)(O,{song:e},e.title)}))),Object(u.jsxs)("div",{children:[Object(u.jsx)("h1",{children:"Listener Songs"}),t?e:"not logged on"]})},x=n(7);var f=function(e){for(var t=e.rating,n=e.song,s=e.songs,i=e.setSongs,r="",a=Object(c.useContext)(h),l=t.listener_name,j=0;j<t.review;j++)r+="\u2b50";var d=Object(c.useState)(!1),b=Object(o.a)(d,2),O=b[0],g=b[1],x=Object(c.useState)(""),f=Object(o.a)(x,2),p=f[0],m=f[1];return Object(u.jsxs)("div",{id:"rating",children:[Object(u.jsxs)("h3",{children:[l," :"]}),Object(u.jsx)("h5",{children:r}),Object(u.jsx)("h5",{children:t.comment}),Object(u.jsxs)("form",{id:"update_rating",onSubmit:function(e){e.preventDefault(),e.target.children[0].value="",null!=a&&a.id==t.listener_id?fetch("/songs/".concat(n.id,"/ratings/").concat(t.id),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({comment:p})}).then((function(e){return e.json()})).then((function(e){console.log(e);var c=n.ratings.map((function(t){return t.id==e.id?e:t}));n.ratings=c;var r=s.map((function(e){return e.id==t.song_id?n:e}));i(r)})):(g(!0),setTimeout((function(){g(!1)}),"1500"))},children:[Object(u.jsx)("input",{name:"comment",type:"text",onChange:function(e){e.preventDefault(),m(e.target.value)}}),Object(u.jsx)("input",{type:"submit",value:"Change Comment"})]}),Object(u.jsx)("button",{id:"delete",onClick:function(e){e.preventDefault(),null!=a&&a.id==t.listener_id?fetch("/songs/".concat(n.id,"/ratings/").concat(t.id),{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify(null)}).then((function(e){return console.log(e)})).then((function(){var e=n.ratings.filter((function(e){return e.id!=t.id}));n.ratings=e;var c=s.map((function(e){return e.id==t.song_id?n:e}));i(c),a.songs=a.songs.filter((function(e){return e.id!=t.song_id}))})):(g(!0),setTimeout((function(){g(!1)}),"1500"))},children:"X"}),Object(u.jsx)("h5",{style:{color:"red"},children:O?"Listeners can only edit their own ratings":null})]})};var p=function(e){var t=e.song,n=e.songs,s=e.setSongs,i=Object(c.useContext)(h),r=Object(c.useState)(!1),a=Object(o.a)(r,2),d=a[0],b=a[1],O=t.ratings,g=Object(c.useState)(!1),p=Object(o.a)(g,2),m=p[0],v=p[1],S=O.reduce((function(e,t){return e+t.review}),0)/O.length,y=O.map((function(e){return e.listener_id})),C=Object(c.useState)(!1),w=Object(o.a)(C,2),T=w[0],L=w[1],N=Object(c.useState)(""),_=Object(o.a)(N,2),P=_[0],k=_[1],E=Object(c.useState)({review:1,comment:"",song_id:t.id,listener_id:null}),D=Object(o.a)(E,2),J=D[0],R=D[1];function A(e){var t,n=e.target.name;R(Object(j.a)(Object(j.a)({},J),{},(t={},Object(l.a)(t,n,e.target.value),Object(l.a)(t,"listener_id",i.id),t)))}fetch("https://itunes.apple.com/search?media=music&entity=song&term=".concat(t.title)).then((function(e){return e.json()})).then((function(e){var n=e.results.filter((function(e){return e.artistName==t.artist}))[0];k(n.artworkUrl100)}));var I=O.map((function(e){return Object(u.jsx)(f,{rating:e,song:t,songs:n,setSongs:s},e.id)}));return Object(u.jsxs)("div",{className:"song-card",children:[Object(u.jsxs)("div",{className:"left",children:[Object(u.jsx)("h2",{children:t.title}),Object(u.jsxs)("h5",{children:["by ",t.artist]}),Object(u.jsx)("img",{src:P,alt:"album cover"})]}),Object(u.jsxs)("div",{className:"right",children:[Object(u.jsxs)("p",{children:["Average Listener Rating: ",S>0?S:0]}),Object(u.jsx)("h5",{style:{color:"red"},children:T?"You've already rated this song":null}),d?Object(u.jsxs)("form",{id:"make_rating",onSubmit:function(e){e.preventDefault(),b(!1),y.includes(i.id)?(L(!0),setTimeout((function(){L(!1)}),"1500")):fetch("/songs/".concat(t.id,"/ratings"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(J)}).then((function(e){return e.json()})).then((function(e){var c=[].concat(Object(x.a)(O),[e]);t.ratings=c;var r=n.map((function(n){return n.id==e.song_id?t:n}));s(r),i.songs=[].concat(Object(x.a)(i.songs),[t])}))},children:[Object(u.jsxs)("select",{name:"review",type:"number",onChange:A,children:[Object(u.jsx)("option",{value:"1",children:"1"}),Object(u.jsx)("option",{value:"2",children:"2"}),Object(u.jsx)("option",{value:"3",children:"3"}),Object(u.jsx)("option",{value:"4",children:"4"}),Object(u.jsx)("option",{value:"5",children:"5"})]}),Object(u.jsx)("label",{children:"Comment:"}),Object(u.jsx)("input",{name:"comment",type:"text",onChange:A}),Object(u.jsx)("input",{name:"submit",type:"submit"})]}):Object(u.jsx)("button",{onClick:function(){b(!!i)},children:i?"Rate Me!":"Log In to Rate Me!"}),m?Object(u.jsxs)("div",{children:[Object(u.jsx)("button",{onClick:function(){return v(!1)},children:"Hide Ratings"}),I]}):Object(u.jsx)("button",{onClick:function(){return v(!0)},children:"Show Ratings"})]})]})};var m=function(e){var t=e.songs,n=e.setSongs,c=t.map((function(e){return Object(u.jsx)(p,{song:e,songs:t,setSongs:n},e.title)}));return Object(u.jsx)("div",{className:"song-container",children:c})};var v=function(e){var t=e.songs,n=e.setSongs,s=Object(c.useState)({title:"",artist:""}),i=Object(o.a)(s,2),r=i[0],a=i[1];function d(e){var t=e.target.name;a(Object(j.a)(Object(j.a)({},r),{},Object(l.a)({},t,e.target.value)))}return Object(u.jsxs)("div",{children:[Object(u.jsx)("h1",{children:"Add song"}),Object(u.jsxs)("form",{id:"create_songs",onSubmit:function(e){e.preventDefault(),fetch("",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}).then((function(e){return e.json()})).then((function(e){n([].concat(Object(x.a)(t),[e]))})),e.target.children[1].value="",e.target.children[3].value=""},children:[Object(u.jsx)("h5",{children:"Title:"}),Object(u.jsx)("input",{type:"text",name:"title",onChange:d}),Object(u.jsx)("h5",{children:"Artist:"}),Object(u.jsx)("input",{type:"text",name:"artist",onChange:d}),Object(u.jsx)("input",{type:"submit",value:"Create Song"})]})]})},S=n(25),y=n(12),C=["to","children"];function w(e){var t=e.to,n=e.children,c=Object(S.a)(e,C),s=Object(a.q)(t),i=Object(a.m)({path:s.pathname,end:!0});return Object(u.jsx)("li",{className:i?"active":"",children:Object(u.jsx)(y.b,Object(j.a)(Object(j.a)({to:t},c),{},{children:n}))})}var T=function(){var e=Object(c.useContext)(h);return Object(u.jsxs)("nav",{className:"nav",children:[Object(u.jsx)(y.b,{to:"/",class:"site-name",children:"Song Rater \u2b50"}),e?Object(u.jsx)("p",{children:"Welcome ".concat(e.name,"!")}):null,Object(u.jsxs)("ul",{children:[Object(u.jsx)(w,{to:"/songs",children:"Songs"}),Object(u.jsx)(w,{to:"/listeners",children:"Listener Songs"}),e?Object(u.jsx)(w,{to:"/logout",children:"Logout"}):Object(u.jsx)(w,{to:"/login",children:"Login or Signup"})]})]})};var L=function(){return Object(u.jsxs)("div",{className:"home",children:[Object(u.jsx)("h3",{children:"Song Rater About :"}),Object(u.jsx)("p",{children:"Song rater is an application that can be used to rate and comment on some of your favorite songs. Leave ratings and see other listeners ratings, as well as songs average listener rating! "}),Object(u.jsx)("h4",{children:" Getting started : "}),Object(u.jsxs)("ul",{children:[Object(u.jsx)("li",{children:"Login or Sign up in the top right corner"}),Object(u.jsx)("li",{children:"Once logged in you can browse songs you've rated on the Listener Songs tab"}),Object(u.jsx)("li",{children:"Browse all songs and their ratings on the Songs tab, new Songs are added externally"}),Object(u.jsx)("li",{children:"Under each song listeners can create, delete, or edit Ratings"}),Object(u.jsx)("li",{children:"Listeners can only edit or delete their own ratings, and each listener can only rate a song once"}),Object(u.jsx)("li",{children:"When done browsing, go to the logout tab and click Logout"}),Object(u.jsx)("li",{children:"To return to the home page click the Song Rater icon on the top left"})]})]})};n(34);var N=function(){var e=Object(c.useState)(null),t=Object(o.a)(e,2),n=t[0],s=t[1],i=Object(c.useState)([]),r=Object(o.a)(i,2),l=r[0],j=r[1];return Object(c.useEffect)((function(){fetch("/songs").then((function(e){return e.json()})).then((function(e){j(e)}))}),[]),Object(c.useEffect)((function(){fetch("/me").then((function(e){if(!e.ok)throw new Error("HTTP error, status = ".concat(e.status));e.json().then((function(e){s(e)}))})).catch((function(e){console.error(e)}))}),[]),Object(u.jsx)("div",{className:"App",children:Object(u.jsxs)(h.Provider,{value:n,children:[Object(u.jsx)(T,{}),Object(u.jsx)("div",{className:"container",children:Object(u.jsxs)(a.c,{children:[Object(u.jsx)(a.a,{path:"/",element:Object(u.jsx)(L,{})}),Object(u.jsx)(a.a,{path:"/songs",element:Object(u.jsx)(m,{songs:l,setSongs:j})}),Object(u.jsx)(a.a,{path:"/listeners",element:Object(u.jsx)(g,{songs:l})}),Object(u.jsx)(a.a,{path:"/login",element:Object(u.jsx)(d,{setListener:s})}),Object(u.jsx)(a.a,{path:"/logout",element:Object(u.jsx)(b,{setListener:s})}),Object(u.jsx)(a.a,{path:"/songs/new",element:Object(u.jsx)(v,{songs:l,setSongs:j})})]})})]})})},_=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,36)).then((function(t){var n=t.getCLS,c=t.getFID,s=t.getFCP,i=t.getLCP,r=t.getTTFB;n(e),c(e),s(e),i(e),r(e)}))};r.a.render(Object(u.jsx)(s.a.StrictMode,{children:Object(u.jsx)(y.a,{children:Object(u.jsx)(N,{})})}),document.getElementById("root")),_()}},[[35,1,2]]]);
//# sourceMappingURL=main.2e5cac0e.chunk.js.map